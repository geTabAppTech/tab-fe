__d((function(g,r,_i,a,_m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.encodeIntoResult=$,e.stegaEncodeSourceMap=j,e.stegaEncodeSourceMap$1=void 0;var t=r(d[0]);const n=/_key\s*==\s*['"](.*)['"]/;function o(t){return"string"==typeof t?n.test(t.trim()):"object"==typeof t&&"_key"in t}function s(t){if(!Array.isArray(t))throw new Error("Path is not an array");return t.reduce(((t,n,s)=>{const i=typeof n;if("number"===i)return`${t}[${n}]`;if("string"===i)return`${t}${0===s?"":"."}${n}`;if(o(n)&&n._key)return`${t}[_key=="${n._key}"]`;if(Array.isArray(n)){const[o,s]=n;return`${t}[${o}:${s}]`}throw new Error(`Unsupported path segment \`${JSON.stringify(n)}\``)}),"")}const i={"\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","'":"\\'","\\":"\\\\"},u={"\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t","\\'":"'","\\\\":"\\"};function c(t){return`$${t.map((t=>"string"==typeof t?`['${t.replace(/[\f\n\r\t'\\]/g,(t=>i[t]))}']`:"number"==typeof t?`[${t}]`:""!==t._key?`[?(@._key=='${t._key.replace(/['\\]/g,(t=>i[t]))}')]`:`[${t._index}]`)).join("")}`}function l(t){const n=[],o=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;let s;for(;null!==(s=o.exec(t));)if(void 0===s[1])if(void 0===s[2])if(void 0===s[3]);else{const t=s[3].replace(/\\(\\')/g,(t=>u[t]));n.push({_key:t,_index:-1})}else n.push(parseInt(s[2],10));else{const t=s[1].replace(/\\(\\|f|n|r|t|')/g,(t=>u[t]));n.push(t)}return n}function p(t){return t.map((t=>{if("string"==typeof t||"number"==typeof t)return t;if(""!==t._key)return{_key:t._key};if(-1!==t._index)return t._index;throw new Error(`invalid segment:${JSON.stringify(t)}`)}))}function f(t,n){if(!n?.mappings)return;const o=c(t.map((t=>{if("string"==typeof t||"number"==typeof t)return t;if(-1!==t._index)return t._index;throw new Error(`invalid segment:${JSON.stringify(t)}`)})));if(void 0!==n.mappings[o])return{mapping:n.mappings[o],matchedPath:o,pathSuffix:""};const s=Object.entries(n.mappings).filter((t=>{let[n]=t;return o.startsWith(n)})).sort(((t,n)=>{let[o]=t,[s]=n;return s.length-o.length}));if(0==s.length)return;const[i,u]=s[0];return{mapping:u,matchedPath:i,pathSuffix:o.substring(i.length)}}function h(t){return null!==t&&Array.isArray(t)}function y(t){return"object"==typeof t&&null!==t}function m(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return h(t)?t.map(((t,s)=>{if(y(t)){const i=t._key;if("string"==typeof i)return m(t,n,o.concat({_key:i,_index:s}))}return m(t,n,o.concat(s))})):y(t)?Object.fromEntries(Object.entries(t).map((t=>{let[s,i]=t;return[s,m(i,n,o.concat(s))]}))):n(t,o)}function $(t,n,o){return m(t,((t,s)=>{if("string"!=typeof t)return t;const i=f(s,n);if(!i)return t;const{mapping:u,matchedPath:c}=i;if("value"!==u.type||"documentValue"!==u.source.type)return t;const p=n.documents[u.source.document],h=n.paths[u.source.path],y=l(c),m=l(h).concat(s.slice(y.length));return o({sourcePath:m,sourceDocument:p,resultPath:s,value:t})}))}const _="drafts.";function b(t){return t.startsWith(_)?t.slice(_.length):t}function k(t){const{baseUrl:n,workspace:o="default",tool:i="default",id:u,type:c,path:l,projectId:f,dataset:h}=t;if(!n)throw new Error("baseUrl is required");if(!l)throw new Error("path is required");if(!u)throw new Error("id is required");if("/"!==n&&n.endsWith("/"))throw new Error("baseUrl must not end with a slash");const y="default"===o?void 0:o,m="default"===i?void 0:i,$=b(u),k=Array.isArray(l)?s(p(l)):l,w=new URLSearchParams({baseUrl:n,id:$,type:c,path:k});y&&w.set("workspace",y),m&&w.set("tool",m),f&&w.set("projectId",f),h&&w.set("dataset",h),u.startsWith(_)&&w.set("isDraft","");const v=["/"===n?"":n];y&&v.push(y);const U=["mode=presentation",`id=${$}`,`type=${c}`,`path=${encodeURIComponent(k)}`];return m&&U.push(`tool=${m}`),v.push("intent","edit",`${U.join(";")}?${w}`),v.join("/")}function w(t){let n="string"==typeof t?t:t.baseUrl;return"/"!==n&&(n=n.replace(/\/$/,"")),"string"==typeof t?{baseUrl:n}:{...t,baseUrl:n}}const v=t=>{let{sourcePath:n,resultPath:o,value:s}=t;if(/^\d{4}-\d{2}-\d{2}/.test(i=s)&&Date.parse(i)||E(s))return!1;var i;const u=n.at(-1);return!("slug"===n.at(-2)&&"current"===u||"string"==typeof u&&u.startsWith("_")||"number"==typeof u&&"marks"===n.at(-2)||"href"===u&&"number"==typeof n.at(-2)&&"markDefs"===n.at(-3)||"style"===u||"listItem"===u||n.some((t=>"meta"===t||"metadata"===t||"openGraph"===t||"seo"===t))||P(n)||P(o)||"string"==typeof u&&U.has(u))},U=new Set(["color","colour","currency","email","format","gid","hex","href","hsl","hsla","icon","id","index","key","language","layout","link","linkAction","locale","lqip","page","path","ref","rgb","rgba","route","secret","slug","status","tag","template","theme","type","unit","url","username","variant","website"]);function E(t){try{new URL(t,t.startsWith("/")?"https://acme.com":void 0)}catch{return!1}return!0}function P(t){return t.some((t=>"string"==typeof t&&null!==t.match(/type/i)))}const S=20;function j(o,s,i){const{filter:u,logger:c,enabled:l}=i;if(!l){const t="config.enabled must be true, don't call this function otherwise";throw c?.error?.(`[@sanity/client]: ${t}`,{result:o,resultSourceMap:s,config:i}),new TypeError(t)}if(!s)return c?.error?.("[@sanity/client]: Missing Content Source Map from response body",{result:o,resultSourceMap:s,config:i}),o;if(!i.studioUrl){const t="config.studioUrl must be defined";throw c?.error?.(`[@sanity/client]: ${t}`,{result:o,resultSourceMap:s,config:i}),new TypeError(t)}const p={encoded:[],skipped:[]},f=$(o,s,(n=>{let{sourcePath:o,sourceDocument:s,resultPath:l,value:f}=n;if(!1===("function"==typeof u?u({sourcePath:o,resultPath:l,filterDefault:v,sourceDocument:s,value:f}):v({sourcePath:o,resultPath:l,filterDefault:v,sourceDocument:s,value:f})))return c&&p.skipped.push({path:x(o),value:`${f.slice(0,S)}${f.length>S?"...":""}`,length:f.length}),f;c&&p.encoded.push({path:x(o),value:`${f.slice(0,S)}${f.length>S?"...":""}`,length:f.length});const{baseUrl:h,workspace:y,tool:m}=w("function"==typeof i.studioUrl?i.studioUrl(s):i.studioUrl);if(!h)return f;const{_id:$,_type:_,_projectId:b,_dataset:U}=s;return(0,t.C)(f,{origin:"sanity.io",href:k({baseUrl:h,workspace:y,tool:m,id:$,type:_,path:o,...!i.omitCrossDatasetReferenceData&&{dataset:U,projectId:b}})},!1)}));if(c){const t=p.skipped.length,o=p.encoded.length;if((t||o)&&((c?.groupCollapsed||c.log)?.("[@sanity/client]: Encoding source map into result"),c.log?.(`[@sanity/client]: Paths encoded: ${p.encoded.length}, skipped: ${p.skipped.length}`)),p.encoded.length>0&&(c?.log?.("[@sanity/client]: Table of encoded paths"),(c?.table||c.log)?.(p.encoded)),p.skipped.length>0){const t=new Set;for(const{path:o}of p.skipped)t.add(o.replace(n,"0").replace(/\[\d+\]/g,"[]"));c?.log?.("[@sanity/client]: List of skipped paths",[...t.values()])}(t||o)&&c?.groupEnd?.()}return f}function x(t){return s(p(t))}e.stegaEncodeSourceMap$1=Object.freeze({__proto__:null,stegaEncodeSourceMap:j})}),5445,[5300]);