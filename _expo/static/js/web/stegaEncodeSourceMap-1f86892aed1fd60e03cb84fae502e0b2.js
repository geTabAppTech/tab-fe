__d((function(g,r,_i2,a,_m,e,d){Object.defineProperty(e,"__esModule",{value:!0}),e.encodeIntoResult=$,e.stegaEncodeSourceMap=j,e.stegaEncodeSourceMap$1=void 0;var t=r(d[0]);const n=/_key\s*==\s*['"](.*)['"]/;function o(t){return"string"==typeof t?n.test(t.trim()):"object"==typeof t&&"_key"in t}function s(t){if(!Array.isArray(t))throw new Error("Path is not an array");return t.reduce(((t,n,s)=>{const i=typeof n;if("number"===i)return`${t}[${n}]`;if("string"===i)return`${t}${0===s?"":"."}${n}`;if(o(n)&&n._key)return`${t}[_key=="${n._key}"]`;if(Array.isArray(n)){const[o,s]=n;return`${t}[${o}:${s}]`}throw new Error(`Unsupported path segment \`${JSON.stringify(n)}\``)}),"")}const i={"\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","'":"\\'","\\":"\\\\"},l={"\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t","\\'":"'","\\\\":"\\"};function u(t){return`$${t.map((t=>"string"==typeof t?`['${t.replace(/[\f\n\r\t'\\]/g,(t=>i[t]))}']`:"number"==typeof t?`[${t}]`:""!==t._key?`[?(@._key=='${t._key.replace(/['\\]/g,(t=>i[t]))}')]`:`[${t._index}]`)).join("")}`}function c(t){const n=[],o=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;let s;for(;null!==(s=o.exec(t));)if(void 0===s[1])if(void 0===s[2])if(void 0===s[3]);else{const t=s[3].replace(/\\(\\')/g,(t=>l[t]));n.push({_key:t,_index:-1})}else n.push(parseInt(s[2],10));else{const t=s[1].replace(/\\(\\|f|n|r|t|')/g,(t=>l[t]));n.push(t)}return n}function p(t){return t.map((t=>{if("string"==typeof t||"number"==typeof t)return t;if(""!==t._key)return{_key:t._key};if(-1!==t._index)return t._index;throw new Error(`invalid segment:${JSON.stringify(t)}`)}))}function f(t,n){if(null==n||!n.mappings)return;const o=u(t.map((t=>{if("string"==typeof t||"number"==typeof t)return t;if(-1!==t._index)return t._index;throw new Error(`invalid segment:${JSON.stringify(t)}`)})));if(void 0!==n.mappings[o])return{mapping:n.mappings[o],matchedPath:o,pathSuffix:""};const s=Object.entries(n.mappings).filter((t=>{let[n]=t;return o.startsWith(n)})).sort(((t,n)=>{let[o]=t,[s]=n;return s.length-o.length}));if(0==s.length)return;const[i,l]=s[0];return{mapping:l,matchedPath:i,pathSuffix:o.substring(i.length)}}function h(t){return null!==t&&Array.isArray(t)}function y(t){return"object"==typeof t&&null!==t}function m(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return h(t)?t.map(((t,s)=>{if(y(t)){const i=t._key;if("string"==typeof i)return m(t,n,o.concat({_key:i,_index:s}))}return m(t,n,o.concat(s))})):y(t)?Object.fromEntries(Object.entries(t).map((t=>{let[s,i]=t;return[s,m(i,n,o.concat(s))]}))):n(t,o)}function $(t,n,o){return m(t,((t,s)=>{if("string"!=typeof t)return t;const i=f(s,n);if(!i)return t;const{mapping:l,matchedPath:u}=i;if("value"!==l.type||"documentValue"!==l.source.type)return t;const p=n.documents[l.source.document],h=n.paths[l.source.path],y=c(u),m=c(h).concat(s.slice(y.length));return o({sourcePath:m,sourceDocument:p,resultPath:s,value:t})}))}const _="drafts.";function b(t){return t.startsWith(_)?t.slice(_.length):t}function v(t){const{baseUrl:n,workspace:o="default",tool:i="default",id:l,type:u,path:c,projectId:f,dataset:h}=t;if(!n)throw new Error("baseUrl is required");if(!c)throw new Error("path is required");if(!l)throw new Error("id is required");if("/"!==n&&n.endsWith("/"))throw new Error("baseUrl must not end with a slash");const y="default"===o?void 0:o,m="default"===i?void 0:i,$=b(l),v=Array.isArray(c)?s(p(c)):c,k=new URLSearchParams({baseUrl:n,id:$,type:u,path:v});y&&k.set("workspace",y),m&&k.set("tool",m),f&&k.set("projectId",f),h&&k.set("dataset",h),l.startsWith(_)&&k.set("isDraft","");const w=["/"===n?"":n];y&&w.push(y);const U=["mode=presentation",`id=${$}`,`type=${u}`,`path=${encodeURIComponent(v)}`];return m&&U.push(`tool=${m}`),w.push("intent","edit",`${U.join(";")}?${k}`),w.join("/")}function k(t){let n="string"==typeof t?t:t.baseUrl;return"/"!==n&&(n=n.replace(/\/$/,"")),"string"==typeof t?{baseUrl:n}:{...t,baseUrl:n}}const w=t=>{let{sourcePath:n,resultPath:o,value:s}=t;if(/^\d{4}-\d{2}-\d{2}/.test(i=s)&&Date.parse(i)||E(s))return!1;var i;const l=n.at(-1);return!("slug"===n.at(-2)&&"current"===l||"string"==typeof l&&l.startsWith("_")||"number"==typeof l&&"marks"===n.at(-2)||"href"===l&&"number"==typeof n.at(-2)&&"markDefs"===n.at(-3)||"style"===l||"listItem"===l||n.some((t=>"meta"===t||"metadata"===t||"openGraph"===t||"seo"===t))||P(n)||P(o)||"string"==typeof l&&U.has(l))},U=new Set(["color","colour","currency","email","format","gid","hex","href","hsl","hsla","icon","id","index","key","language","layout","link","linkAction","locale","lqip","page","path","ref","rgb","rgba","route","secret","slug","status","tag","template","theme","type","unit","url","username","variant","website"]);function E(t){try{new URL(t,t.startsWith("/")?"https://acme.com":void 0)}catch{return!1}return!0}function P(t){return t.some((t=>"string"==typeof t&&null!==t.match(/type/i)))}const S=20;function j(o,s,i){var l,u,c,p,f,h,y,m,_;const{filter:b,logger:U,enabled:E}=i;if(!E){const t="config.enabled must be true, don't call this function otherwise";throw null==(l=null==U?void 0:U.error)||l.call(U,`[@sanity/client]: ${t}`,{result:o,resultSourceMap:s,config:i}),new TypeError(t)}if(!s)return null==(u=null==U?void 0:U.error)||u.call(U,"[@sanity/client]: Missing Content Source Map from response body",{result:o,resultSourceMap:s,config:i}),o;if(!i.studioUrl){const t="config.studioUrl must be defined";throw null==(c=null==U?void 0:U.error)||c.call(U,`[@sanity/client]: ${t}`,{result:o,resultSourceMap:s,config:i}),new TypeError(t)}const P={encoded:[],skipped:[]},j=$(o,s,(n=>{let{sourcePath:o,sourceDocument:s,resultPath:l,value:u}=n;if(!1===("function"==typeof b?b({sourcePath:o,resultPath:l,filterDefault:w,sourceDocument:s,value:u}):w({sourcePath:o,resultPath:l,filterDefault:w,sourceDocument:s,value:u})))return U&&P.skipped.push({path:x(o),value:`${u.slice(0,S)}${u.length>S?"...":""}`,length:u.length}),u;U&&P.encoded.push({path:x(o),value:`${u.slice(0,S)}${u.length>S?"...":""}`,length:u.length});const{baseUrl:c,workspace:p,tool:f}=k("function"==typeof i.studioUrl?i.studioUrl(s):i.studioUrl);if(!c)return u;const{_id:h,_type:y,_projectId:m,_dataset:$}=s;return(0,t.C)(u,{origin:"sanity.io",href:v({baseUrl:c,workspace:p,tool:f,id:h,type:y,path:o,...!i.omitCrossDatasetReferenceData&&{dataset:$,projectId:m}})},!1)}));if(U){const t=P.skipped.length,o=P.encoded.length;if((t||o)&&(null==(p=(null==U?void 0:U.groupCollapsed)||U.log)||p("[@sanity/client]: Encoding source map into result"),null==(f=U.log)||f.call(U,`[@sanity/client]: Paths encoded: ${P.encoded.length}, skipped: ${P.skipped.length}`)),P.encoded.length>0&&(null==(h=null==U?void 0:U.log)||h.call(U,"[@sanity/client]: Table of encoded paths"),null==(y=(null==U?void 0:U.table)||U.log)||y(P.encoded)),P.skipped.length>0){const t=new Set;for(const{path:o}of P.skipped)t.add(o.replace(n,"0").replace(/\[\d+\]/g,"[]"));null==(m=null==U?void 0:U.log)||m.call(U,"[@sanity/client]: List of skipped paths",[...t.values()])}(t||o)&&(null==(_=null==U?void 0:U.groupEnd)||_.call(U))}return j}function x(t){return s(p(t))}e.stegaEncodeSourceMap$1=Object.freeze({__proto__:null,stegaEncodeSourceMap:j})}),5286,[4996]);